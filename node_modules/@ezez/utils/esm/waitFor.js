const DEFAULT_INTERVAL = 50;
const waitFor = (fn, interval = DEFAULT_INTERVAL, timeout = Infinity) => {
    return new Promise((resolve, reject) => {
        let intervalTimer, failTimer;
        if (isFinite(timeout)) {
            failTimer = setTimeout(() => {
                reject(new Error("[waitFor] Timeout"));
                clearInterval(intervalTimer);
            }, timeout);
        }
        intervalTimer = setInterval(() => {
            try {
                const result = fn();
                if (result) {
                    clearTimeout(failTimer);
                    clearInterval(intervalTimer);
                    resolve(result);
                }
            }
            catch (error) {
                clearTimeout(failTimer);
                clearInterval(intervalTimer);
                const e = new Error("[waitFor] check function threw an error");
                e.details = { error };
                reject(e);
            }
        }, interval);
    });
};
export { waitFor };
//# sourceMappingURL=waitFor.js.map